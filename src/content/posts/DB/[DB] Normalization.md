---
title: "[DB] Normalization(정규화)"
published: 2024-07-02
description: ''
image: ''
tags: [CS, DB, Normalization]
category: 'DataBase'
draft: false 
---
# 개요

DB, 즉 관계형 DB는 한개의 테이블에 여러 엔티티를 넣으면 중복된 정보로 인해 Anomaly현상이 발생한다. 이러한 문제를 해결하기 위해 Normalization을 한다.

쉽게 말하면 엑셀을 떠올리면 좋다.

엑셀을 많이 작업해본 사람이면 알것이다. 엑셀 표를 나누어 나중에 VLOOKUP과 같은 함수를 써서 원하는 Value를 얻어낸다. 만약에 한 엑셀표에 모든 정보가 들어가 있으면 어떨까?

내가 원하는 정보만 찾고 있어야하는데 쓸모없는 데이터, 지우지 말아야할 데이터가 있을 수 있다. 그래서 정규화를 하는 것이다.

설계 단계에서 애초에 정규화를 하는 DBA라면 최고의 DBA가 아닐까?

## Anomaly(이상현상)

이상 현상은 총 3가지이다.

- 삽입이상: 새 데이터를 삽입할때, 불필요한 데이터를 함께 삽입하는 현상
- 삭제이상: 튜플을 삭제할때 필요한 데이터까지 삭제되는 현상
- 갱신이상: 반복되는 데이터 중에 일부를 수정할때, 데이터가 불일치되는 현성

## Normalization(정규화) 과정

Normalization는 4단계로 보통 이야기를 한다. 알고 있어야할 점이 제 1 정규화를 해야 제 2정규화, 그 다음 정규화를 할 수 있다.

선행이 이루어지지 않으면 다음 단계의 정규화를 만족하지 않으면 진행할 수 없다.

아래의 표는 비정규화된 테이블이다.

| 책ID | 제목     |          저자           |    저자 국적     |  출판사  | 출판사 주소 |
|:---:|--------|:---------------------:|:------------:|:-----:|:------:|
|  1  | 데이터베이스 |      Alice, Bob       |    한국, 미국    | 출판사 A |   서울   |
|  2  | 네트워크   |  Charlie, David, Eve  | 	영국, 한국, 프랑스 | 출판사 B |   부산   |
|  3  | 머신러닝   |         Frank         |      일본      | 출판사 C |   대구   |

### 제 1 정규화

"**도메인이 오직 원자값으로 이루어져 있어야한다.**"

|  책ID  |    제목    |    저자     |  저자 국적  |   출판사   |  출판사 주소  |
|:-----:|:--------:|:---------:|:-------:|:-------:|:--------:|
|   1   |  데이터베이스  |   Alice   |   한국    |  출판사 A  |    서울    |
|   1   |  데이터베이스  |    Bob    |   미국    |  출판사 A  |    서울    |
|   2   |   네트워크   |  Charlie  |   영국    |  출판사 B  |    부산    |
|   2   |   네트워크   |   David   |   한국    |  출판사 B  |    부산    |
|   2   |   네트워크   |    Eve    |   프랑스   |  출판사 B  |    부산    |
|   3   |   머신러닝   |   Frank   |   일본    |  출판사 C  |    대구    |

### 제 2 정규화

"**부분적 함수 종속제거**"

#### 책-저자 테이블

|  책ID   |        제목        |    저자     |    저자 국적    |      출판사      |
|:------:|:----------------:|:---------:|:-----------:|:-------------:|
|   1    |      데이터베이스      |   Alice   |     한국      |     출판사 A     |
|   1    |      데이터베이스      |    Bob    |     미국      |     출판사 A     |
|   2    |       네트워크       |  Charlie  |     영국      |     출판사 B     |
|   2    |       네트워크       |   David   |     한국      |     출판사 B     |
|   2    |       네트워크       |    Eve    |     프랑스     |     출판사 B     |
|   3    |       머신러닝       |   Frank   |     일본      |     출판사 C     |

#### 출판사 테이블

|    출판사    |    출판사 주소     |
|:---------:|:-------------:|
|   출판사 A   |      서울       |
|   출판사 B   |      부산       |
|   출판사 C   |      대구       |

### 제 3 정규화

"**이행적 함수 종속제거**"

#### 책-저자 테이블

|  책ID   |        제목        |    저자     |      출판사      |
|:------:|:----------------:|:---------:|:-------------:|
|   1    |      데이터베이스      |   Alice   |     출판사 A     |
|   1    |      데이터베이스      |    Bob    |     출판사 A     |
|   2    |       네트워크       |  Charlie  |     출판사 B     |
|   2    |       네트워크       |   David   |     출판사 B     |
|   2    |       네트워크       |    Eve    |     출판사 B     |
|   3    |       머신러닝       |   Frank   |     출판사 C     |

#### 저자 테이블

|    저자     |    저자 국적    |
|:---------:|:-----------:|
|   Alice   |     한국      |
|    Bob    |     미국      |
|  Charlie  |     영국      |
|   David   |     한국      |
|    Eve    |     프랑스     |
|   Frank   |     일본      |

#### 출판사 테이블

|    출판사    |    출판사 주소     |
|:---------:|:-------------:|
|   출판사 A   |      서울       |
|   출판사 B   |      부산       |
|   출판사 C   |      대구       |

### BNCF(Boyce-Codd Normal Function)

"**결정자면서 후보키가 아닌것을 제거**"

#### 책 테이블

|  책ID   |        제목        |      출판사      |
|:------:|:----------------:|:-------------:|
|   1    |      데이터베이스      |     출판사 A     |
|   2    |       네트워크       |     출판사 B     |
|   3    |       머신러닝       |     출판사 C     |

#### 책-저자 관계 테이블

|  책ID   |    저자     |
|:------:|:---------:|
|   1    |   Alice   |
|   1    |    Bob    |
|   2    |  Charlie  |
|   2    |   David   |
|   2    |    Eve    |
|   3    |   Frank   |

#### 저자 테이블

|    저자     |    저자 국적    |
|:---------:|:-----------:|
|   Alice   |     한국      |
|    Bob    |     미국      |
|  Charlie  |     영국      |
|   David   |     한국      |
|    Eve    |     프랑스     |
|   Frank   |     일본      |

#### 출판사 테이블

|    출판사    |    출판사 주소     |
|:---------:|:-------------:|
|   출판사 A   |      서울       |
|   출판사 B   |      부산       |
|   출판사 C   |      대구       |


## 역정규화

정규화는 테이블을 분리한다고 생각하면 된다. 정규화로 테이블을 분해하게되면 외래키(Foreign key)의 사용이 늘어난다. 이는 RDBMS에서 조회를 해올때 검색속도가 저하되어 성능에 이슈가 생긴다.

즉, 너무 많이 테이블을 분리하면 테이블끼리 관계형성을 위한 외래키의 사용이 늘어나면서 JOIN을 많이해야한다. JOIN을 많이하면 성능이 저하됨으로 성능을 향상하는 역정규화를 실행해야한다.

### 릴레이션 역정규화

- 분할: 자주 사용되는 릴레이션을 분해한다.
    - 수직분할: 자주사용하는 속성과 그렇지 않는 속성을 구분
    - 수평분할: 자주사용하는 튜플과 그렇지 않는 튜플을 구분
- 병합: 빈번한 참조로 성능이 저하되기 때문에 병합한다.

### 속성 역정규화

속성과 파생속성을 추가하여 계산의 효율성을 올린다.

---
# FINAL

이렇게 4단계만 거치면 정규화 과정이 이루어져있다고 말할 수 있다. 정규화/정규형 모두 같은 말이니 헷갈리지 말자!